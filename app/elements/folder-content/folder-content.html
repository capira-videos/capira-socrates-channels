<dom-module id="folder-content">
  <style>
    :host {
      @apply(--layout-horizontal);
      @apply(--layout-center-center);
    }

    [content] {
      @apply(--layout-vertical);
      @apply(--shadow-elevation-4dp);
      width: 768px;
      overflow: visible;
      padding-bottom: 22px;
      background-color: white;
    }

    [header],
    folder-list {
      padding: 0 16px 0 24px
    }

    [header] {
      @apply(--layout-horizontal);
      @apply(--layout-center);
      height: 128px;
      background-color: var(--default-primary-color);
    }

    [header] * {
      color: white !important;
    }

    [header-toolbar] {
      @apply(--layout-center);
      margin-bottom: 64px;
    }

    [page-title] {
      @apply(--paper-font-display1);
      max-width: 680px;
    }
  </style>
  <template>

    <div content>
      <div header>
        <span page-title>{{folder.title}}</span>
        <div class="flex"></div>
        <div header-toolbar hidden$="{{folder.admin}}">
          <paper-icon-button icon="social:group" on-click="openPermissions"></paper-icon-button>
        </div>
      </div>
      <folder-list list="{{folder.units}}" list-title="Unit" is-author="{{folder.admin}}"></folder-list>
      <folder-list list="{{folder.folders}}" list-title="Folder" is-author="{{folder.admin}}"></folder-list>

      <!-- The Channel Permissions Editor -->
      <permissions-dialog id="permissions" folder="{{folder}}"></permissions-dialog>
  </template>
</dom-module>
<script>
  (function() {
    Polymer({
      is: 'folder-content',
      openPermissions: function() {
        this.$.permissions.open();
      },


      behaviors: [
        Polymer.NeonAnimationRunnerBehavior
      ],

      properties: {
        folder: {
          observer: '_folderChanged',
        },
        animationConfig: {
          type: Object,
          value: function() {
            return {
              'entry': [{
                name: 'slide-down-animation',
                node: this
              }],
              'exit': [{
                name: 'slide-up-animation',
                node: this
              }]
            }
          }
        }
      },
      _folderChanged: function(newValue,oldValue) {
        console.log('folder changed!',newValue,oldValue);
        if(oldValue && newValue.id==oldValue.parent){
          this.playAnimation('exit');
        } else {
          this.playAnimation('entry');
        }
      }

    });
  })();
</script>
